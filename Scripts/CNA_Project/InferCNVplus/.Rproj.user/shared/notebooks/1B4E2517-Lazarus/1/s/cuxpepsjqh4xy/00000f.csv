"0","# Intersection des annotations et clusters"
"0","  "
"0","all_data@meta.data <- all_data@meta.data %>%"
"0","  mutate(seurat_clusters_rename = case_when("
"0","    "
"0","    # Condition pour cluster Squamous"
"0","    ((seurat_clusters %in% c(3)) & Annotations_new == ""Squamous tumor"") ~ ""Squam_tum"","
"0","    "
"0","    # Condition pour cluster Mesenchymal tumor"
"0","    ((seurat_clusters %in% c(3)) & Annotations_new == ""Mesenchymal tumor"") ~ ""Mes_tum"","
"0","    "
"0","    # Condition pour cluster Épithelial"
"0","    ((seurat_clusters %in% c(2, 4, 17, 15, 7, 11, 12)) & Annotations_new == ""Epithelial tumor"") ~ ""Epi_tum"","
"0","    "
"0","    # Condition pour cluster Spindle"
"0","    ((seurat_clusters %in% c(0, 1, 8, 6, 13, 16)) & Annotations_new == ""Spindle cell tumor"") ~ ""Spindle_tum"","
"0","    "
"0","    # Condition pour cluster Chondro"
"0","    ((seurat_clusters %in% c(5, 9, 10)) & Annotations_new == ""Chondroid tumor"") ~ ""Chondro_tum"","
"0","    "
"0","    # Condition pour cluster Osteosarcomatoid"
"0","    ((seurat_clusters %in% c(0)) & Annotations_new == ""Osteosarcomatoid tumor"") ~ ""Osteo_tum"","
"0","    "
"0","    # Condition pour cluster Mesenchymal normale"
"0","    (Annotations_new == ""Normal mesenchyme"") ~ ""Mes_norm"""
"0","))"
"0",""
"0","# ON enlève les cellules qui n'ont pas de cluster assignés dans seurat_clusters_rename (c-a-d les cellules dont les annotations ne correspondent pas aux clusters trouvés)"
"0","MpBC_obj <- all_data %>% subset(subset = (seurat_clusters_rename != """"))"
"2","Warning: Removing 9670 cells missing data for vars requested"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating Centroids objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating FOV objects"
"2","Warning: Not validating Seurat objects"
"0","# Visu"
"0","p <- DimPlot(MpBC_obj, "
"0","             reduction = ""umap"", "
"0","             group.by = ""seurat_clusters_rename"", "
"0","             label = FALSE,"
"0","             repel = TRUE,"
"0","             pt.size = 0.25) + "
"0","     scale_color_manual(values = cluster_colors_v2) +"
"0","      # annotate(""text"", "
"0","              # x = 9, y = -9.5, "
"0","              # label = """
"0","              # Nombre de cellules totales avant intersection: 51536, "
"0","              # Nombre de cellules enlevées: 9670,"
"0","              # Nombre de cellules restantes après intersection: 41866, "
"0","              # Pourcentage de cellules enlevées: 18.76%"", "
"0","              # size = 2, "
"0","              # color = ""black"", "
"0","              # hjust = 0) +"
"0","     ggtitle(paste0(""MultiLouvain Clustering - Intersection with expert annotations"")) "
"0",""
"0",""
"0","print(p)"
