"0","all_data <- all_data %>% "
"0","  RunUMAP(assay = ""Spatial"","
"0","          seed.use = 42,"
"0","                reduction = ""harmony"","
"0","                dims = 1:20,"
"0","                n.neighbors = 75, "
"0","                min.dist = 0.0001,"
"0","                spread = 2,"
"0","                set.op.mix.ratio = 1,"
"0","                metric = ""cosine"") # euclidean et cosine c'est pas mal"
"2","Warning: The default method for RunUMAP has changed from calling Python UMAP via reticulate to the R-native UWOT using the cosine metric
To use Python UMAP via reticulate, set umap.method to 'umap-learn' and metric to 'correlation'
This message will be shown once per session"
"2","13:18:57 UMAP embedding parameters a = 0.6459 b = 0.7905
"
"2","13:18:57 Read 51536 rows and found 20 numeric columns
"
"2","13:18:57 Using Annoy for neighbor search, n_neighbors = 75
"
"2","13:18:57 Building Annoy index with metric = cosine, n_trees = 50
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"2","13:19:01 Writing NN index file to temp file /tmp/Rtmp07Wqsr/file3b4d83691cd70
"
"2","13:19:01 Searching Annoy index using 1 thread, search_k = 7500
"
"2","13:19:32 Annoy recall = 100%
"
"2","13:19:33 Commencing smooth kNN distance calibration using 1 thread"
"2"," with target n_neighbors = 75
"
"2","13:19:33 2 smooth knn distance failures
"
"2","13:19:35 Initializing from normalized Laplacian + noise (using RSpectra)
"
"2","13:19:37 Commencing optimization for 200 epochs, with 5616710 positive edges
"
"2","Using method '"
"2","umap"
"2","'"
"2","
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"2","13:20:02 Optimization finished
"
"0","neighbours_number_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""n.neighbors""]]"
"0","n_components_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""dims""]] %>% length()"
"0","min_dist_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""min.dist""]]"
"0","set_op_mix_ratio_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""set.op.mix.ratio""]]"
"0","spread_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""spread""]]"
"0","scale_factor_all <- all_data@commands[[""NormalizeData.Spatial""]]@params[[""scale.factor""]]"
"0","metric_all <- all_data@commands[[""RunUMAP.Spatial.harmony""]]@params[[""metric""]]"
"0",""
"0","plot2 <- DimPlot(all_data,"
"0","        pt.size = 0.25,"
"0","        reduction = ""umap"","
"0","        group.by = ""Annotations_new"") +"
"0","    scale_color_manual(values = annotation_colors) +"
"0","    scale_shape_manual(values = shape_patients) +"
"0","    # ggtitle(paste0(""All Patients - Normalized Data ("" ,features_number, "" Genes) - UMAP""))"
"0","    ggtitle(paste0(""UMAP - MpBC patients""))"
"0",""
"0","ggsave(filename = paste0(""Opti_All-Patients_NormalizedData("",features_number, ""_"", neighbours_number_all, ""_"", n_components_all , ""_"", min_dist_all , ""_"", set_op_mix_ratio_all, ""_"", spread_all , ""_"", metric_all, ""_Genes).pdf""), plot = plot2, width = 12, height = 6, dpi = 300)"
"0",""
"0","plot3 <- DimPlot(all_data,"
"0","        pt.size = 0.25,"
"0","        reduction = ""umap"","
"0","        group.by = ""Annotations_old"") +"
"0","    scale_color_manual(values = colors_old) +"
"0","    scale_shape_manual(values = shape_patients) +"
"0","    # ggtitle(paste0(""All Patients - Normalized Data ("" ,features_number, "" Genes) - UMAP - Old""))"
"0","    ggtitle(paste0(""UMAP - MpBC patients""))"
"0",""
"0",""
"0","ggsave(filename = paste0(""Opti_All-Patients_NormalizedData("",features_number, ""_"", neighbours_number_all, ""_"", n_components_all , ""_"", min_dist_all , ""_"", set_op_mix_ratio_all, ""_"", spread_all , ""_"", metric_all, ""_Genes)_old.pdf""), plot = plot3, width = 12, height = 6, dpi = 300)"
