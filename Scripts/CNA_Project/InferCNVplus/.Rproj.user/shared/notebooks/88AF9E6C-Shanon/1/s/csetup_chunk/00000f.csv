"0","knitr::opts_chunk$set(echo = TRUE)"
"0",""
"0","library(Seurat)"
"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(hdf5r)"
"0","library(ggfortify)"
"0","library(harmony)"
"0","library(sctransform)"
"0","library(viridis)"
"0","library(stringr)"
"0","library(viridisLite)"
"0","library(patchwork)"
"0","library(clustree)"
"2","Loading required package: ggraph
"
"2","
Attaching package: ‘ggraph’

"
"2","The following object is masked from ‘package:sp’:

    geometry

"
"0","dir_path <- ""/mnt/datadisk/Jordan/Data/"""
"0",""
"0","Squam_tum_patients <- c(""MpBC3"", ""MpBC8"")"
"0","Epi_tum_patients <- c(""MpBC1"", ""MpBC2"", ""MpBC5"", ""MpBC9"", ""MpBC10"", ""MpBC11"", ""MpBC13"", ""MpBC14"", ""MpBC15"", ""MpBC16"")"
"0","Mes_tum_patients <- c(""MpBC1"", ""MpBC8"")"
"0","Mes_norm_patients <- c(""MpBC1"", ""MpBC2"", ""MpBC5"", ""MpBC6"", ""MpBC9"", ""MpBC11"", ""MpBC14"", ""MpBC15"")"
"0","Spindle_tum_patients <- c(""MpBC2"", ""MpBC3"", ""MpBC4"", ""MpBC5"", ""MpBC6"", ""MpBC7"", ""MpBC10"", ""MpBC11"", ""MpBC14"")"
"0","Osteo_tum_patients <- c(""MpBC4"")"
"0","Chondro_tum_patients <- c(""MpBC9"", ""MpBC13"", ""MpBC15"", ""MpBC16"")"
"0",""
"0","# Assigner des couleurs aux groupes en respectant la proximité biologique"
"0","annotation_colors <- c("
"0","  ""Chondroid tumor"" = ""#8B4513"",          # Marron (cartilage)"
"0","  ""Epithelial tumor"" = ""#FF4500"",         # Orange vif"
"0","  ""Epithelial/Mesenchymal tumor"" = ""#9400D3"", # Violet profond (intermédiaire)"
"0","  ""Mesenchymal tumor"" = ""#1E90FF"",        # Bleu intense"
"0","  ""Normal epithelium"" = ""#32CD32"",        # Vert clair"
"0","  ""Normal mesenchyme"" = ""#00CED1"",        # Turquoise"
"0","  ""Osteosarcomatoid tumor"" = ""black"",   # Brun terreux"
"0","  ""Pleiomorphic tumor"" = ""#B22222"",       # Rouge bordeaux"
"0","  ""Spindle cell tumor"" = ""#4682B4"",       # Bleu acier"
"0","  ""Squamous tumor"" = ""grey""            # Rouge tomate"
"0",")"
"0",""
"0","colors_old <- c("
"0","  ""Chondroid tumour cells"" = ""#E6194B"","
"0","  ""Classical chondrosarcoma cells"" = ""#3CB44B"","
"0","  ""Epithelial tumor cells"" = ""#FFE119"","
"0","  ""Mesenchymal tumor cells"" = ""#4363D8"","
"0","  ""Mixoid chondrosarcoma cells"" =  ""#F58231"","
"0","  ""Mixoid matrix-enriched spindle+ spindle"" = ""#911EB4"","
"0","  ""MMP9- spindle"" = ""#46F0F0"","
"0","  ""MMP9+ spindle"" = ""#F032E6"","
"0","  ""Normal epithelium"" = ""#D2F53C"","
"0","  ""Normal fibrous tissue"" = ""#FABEBE"","
"0","  ""NST cells"" = ""#008080"","
"0","  ""Osteosarcomatoid tumour"" = ""#E6BEFF"","
"0","  ""Spindle cell tumour"" = ""#AA6E28"","
"0","  ""Spindle surrounded by NST"" = ""#FFFAC8"","
"0","  ""Squamous cell tumour"" = ""#800000"", ""#AaffC3"", ""#808000"", ""#000080"""
"0",")"
"0",""
"0","cluster_colors <- c("
"0","  ""#8B4513"",          # Marron (cartilage)"
"0","  ""#FFE119"","
"0","  ""#FF4500"",         # Orange vif"
"0","  ""#9400D3"", # Violet profond (intermédiaire)"
"0","  ""#1E90FF"",        # Bleu intense"
"0","  ""#32CD32"",        # Vert clair"
"0","  ""#46F0F0"",        # Turquoise"
"0","  ""black"",   # Brun terreux"
"0","  ""#B22222"",       # Rouge bordeaux"
"0","  ""#4682B4"",       # Bleu acier"
"0","  ""grey"","
"0","  ""#F032E6"")            # Rouge tomate"
"0",""
"0","cluster_colors_v2 <- c("
"0","  ""Chondro_tum"" = ""#8B4513"",          # Marron (cartilage)"
"0","  ""Epi_tum"" = ""#FF4500"",         # Orange vif"
"0","  ""Mes_tum"" = ""#1E90FF"",        # Bleu intense"
"0","  ""Epi_tum"" = ""#32CD32"",        # Vert clair"
"0","  ""Mes_norm"" = ""#00CED1"",        # Turquoise"
"0","  ""Osteo_tum"" = ""black"",   # Brun terreux"
"0","  ""Spindle_tum"" = ""#4682B4"",       # Bleu acier"
"0","  ""Squam_tum"" = ""grey""            # Rouge tomate"
"0",")"
"0",""
"0","shape_patients = c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14)"
"0",""
